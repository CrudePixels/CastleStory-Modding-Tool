<Window x:Class="CastleStoryLauncher.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Mod Manager" Height="700" Width="1000"
        WindowStartupLocation="CenterScreen"
        Background="#FF2D2D30">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="#FF007ACC" Padding="20">
            <StackPanel>
                <TextBlock Text="Castle Story Mod Manager" 
                          FontSize="28" FontWeight="Bold" 
                          Foreground="White" HorizontalAlignment="Center"/>
                <TextBlock Text="Launch Castle Story with custom mods and settings" 
                          FontSize="14" 
                          Foreground="White" HorizontalAlignment="Center" 
                          Margin="0,5,0,0"/>
            </StackPanel>
        </Border>
        
        <!-- Main Content -->
        <Grid Grid.Row="1" Margin="15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1*"/>
                <ColumnDefinition Width="10"/>
                <ColumnDefinition Width="1*"/>
            </Grid.ColumnDefinitions>
            
            <!-- Left Panel - Game Settings -->
            <GroupBox Grid.Column="0" Header="Game Settings" Foreground="White" FontWeight="Bold">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        
                        <!-- Castle Story Directory -->
                        <GroupBox Header="Castle Story Directory" Foreground="White" FontWeight="Bold" Margin="0,0,0,15">
                            <StackPanel>
                                <TextBox x:Name="GameDirectoryTextBox" 
                                        Background="#FF3C3C3C" Foreground="White" 
                                        BorderBrush="#FF555555" Padding="8" Margin="0,0,0,10"/>
                                <Button x:Name="BrowseGameButton" Content="Browse for Castle Story..." 
                                       Click="BrowseGame_Click" Background="#FF007ACC" 
                                       Foreground="White" BorderBrush="#FF007ACC" Padding="10,5"/>
                                <TextBlock x:Name="GameStatusText" Text="Game not found" 
                                          Foreground="Red" FontWeight="Bold" Margin="0,10,0,0"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- Launch Options -->
                        <GroupBox Header="Launch Options" Foreground="White" FontWeight="Bold" Margin="0,0,0,15">
                            <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="400">
                                <StackPanel>
                                    <TextBlock Text="Display Mode:" Foreground="White" FontWeight="Bold" Margin="0,0,0,8"/>
                                    <RadioButton x:Name="FullscreenRadio" Content="Fullscreen" 
                                               Foreground="White" IsChecked="True" Margin="0,0,0,5"/>
                                    <RadioButton x:Name="WindowedRadio" Content="Windowed Mode" 
                                               Foreground="White" Margin="0,0,0,5"/>
                                    <RadioButton x:Name="BorderlessRadio" Content="Borderless Window" 
                                               Foreground="White" Margin="0,0,0,10"/>
                                    
                                    <TextBlock Text="Resolution:" Foreground="White" FontWeight="Bold" Margin="0,10,0,5"/>
                                    <ComboBox x:Name="ResolutionComboBox" 
                                             Background="#FF3C3C3C" Foreground="White" 
                                             BorderBrush="#FF555555" Padding="5" Margin="0,0,0,10">
                                        <ComboBoxItem Content="1920x1080" IsSelected="True"/>
                                        <ComboBoxItem Content="1680x1050"/>
                                        <ComboBoxItem Content="1600x900"/>
                                        <ComboBoxItem Content="1366x768"/>
                                        <ComboBoxItem Content="1280x720"/>
                                        <ComboBoxItem Content="2560x1440"/>
                                        <ComboBoxItem Content="3840x2160"/>
                                    </ComboBox>
                                    
                                    <TextBlock Text="Graphics Quality:" Foreground="White" FontWeight="Bold" Margin="0,10,0,5"/>
                                    <ComboBox x:Name="QualityComboBox" 
                                             Background="#FF3C3C3C" Foreground="White" 
                                             BorderBrush="#FF555555" Padding="5" Margin="0,0,0,10">
                                        <ComboBoxItem Content="Ultra" IsSelected="True"/>
                                        <ComboBoxItem Content="High"/>
                                        <ComboBoxItem Content="Medium"/>
                                        <ComboBoxItem Content="Low"/>
                                    </ComboBox>
                                    
                                    <CheckBox x:Name="VSyncCheckBox" Content="Enable VSync" 
                                             Foreground="White" IsChecked="True" Margin="0,0,0,10"/>
                                    <CheckBox x:Name="AntiAliasingCheckBox" Content="Enable Anti-Aliasing" 
                                             Foreground="White" IsChecked="True" Margin="0,0,0,10"/>
                                    
                                    <!-- Steam Integration -->
                                    <GroupBox Header="Steam Integration" Foreground="White" FontWeight="Bold" Margin="0,10,0,10">
                                        <StackPanel>
                                            <CheckBox x:Name="SteamOverlayCheckBox" Content="Enable Steam Overlay" 
                                                     Foreground="White" IsChecked="True" Margin="0,0,0,5"/>
                                            <CheckBox x:Name="SteamAchievementsCheckBox" Content="Enable Steam Achievements" 
                                                     Foreground="White" IsChecked="True" Margin="0,0,0,5"/>
                                            <CheckBox x:Name="SteamCloudCheckBox" Content="Enable Steam Cloud Saves" 
                                                     Foreground="White" IsChecked="True" Margin="0,0,0,5"/>
                                            <CheckBox x:Name="SteamOfflineCheckBox" Content="Launch in Steam Offline Mode" 
                                                     Foreground="White" Margin="0,0,0,5"/>
                                            <CheckBox x:Name="SteamBigPictureCheckBox" Content="Launch in Big Picture Mode" 
                                                     Foreground="White" Margin="0,0,0,5"/>
                                        </StackPanel>
                                    </GroupBox>
                                    
                                    <!-- Multiplayer Options -->
                                    <GroupBox Header="Multiplayer Options" Foreground="White" FontWeight="Bold" Margin="0,10,0,10">
                                        <StackPanel>
                                            <CheckBox x:Name="MultiplayerHostCheckBox" Content="Launch as Multiplayer Host" 
                                                     Foreground="White" Margin="0,0,0,5"/>
                                            <CheckBox x:Name="MultiplayerClientCheckBox" Content="Launch as Multiplayer Client" 
                                                     Foreground="White" Margin="0,0,0,5"/>
                                            <CheckBox x:Name="LANModeCheckBox" Content="Enable LAN Mode" 
                                                     Foreground="White" Margin="0,0,0,5"/>
                                            <CheckBox x:Name="DedicatedServerCheckBox" Content="Launch as Dedicated Server" 
                                                     Foreground="White" Margin="0,0,0,5"/>
                                            
                                            <TextBlock Text="Server Port:" Foreground="White" FontWeight="Bold" Margin="0,10,0,5"/>
                                            <TextBox x:Name="ServerPortTextBox" 
                                                    Background="#FF3C3C3C" Foreground="White" 
                                                    BorderBrush="#FF555555" Padding="5" 
                                                    Text="7777" Margin="0,0,0,5"/>
                                            
                                            <TextBlock Text="Max Players:" Foreground="White" FontWeight="Bold" Margin="0,10,0,5"/>
                                            <TextBox x:Name="MaxPlayersTextBox" 
                                                    Background="#FF3C3C3C" Foreground="White" 
                                                    BorderBrush="#FF555555" Padding="5" 
                                                    Text="32" Margin="0,0,0,5"/>
                                        </StackPanel>
                                    </GroupBox>
                                    
                                    <!-- Performance Options -->
                                    <GroupBox Header="Performance Options" Foreground="White" FontWeight="Bold" Margin="0,10,0,10">
                                        <StackPanel>
                                            <CheckBox x:Name="HighPriorityCheckBox" Content="Set High Process Priority" 
                                                     Foreground="White" IsChecked="True" Margin="0,0,0,5"/>
                                            <CheckBox x:Name="DisableFullscreenOptimizationsCheckBox" Content="Disable Fullscreen Optimizations" 
                                                     Foreground="White" Margin="0,0,0,5"/>
                                            <CheckBox x:Name="DisableGameDVRCheckBox" Content="Disable Game DVR" 
                                                     Foreground="White" IsChecked="True" Margin="0,0,0,5"/>
                                            <CheckBox x:Name="DisableWindowsDefenderCheckBox" Content="Disable Windows Defender Real-time Protection" 
                                                     Foreground="White" Margin="0,0,0,5"/>
                                            
                                            <TextBlock Text="Frame Rate Limit:" Foreground="White" FontWeight="Bold" Margin="0,10,0,5"/>
                                            <ComboBox x:Name="FrameRateComboBox" 
                                                     Background="#FF3C3C3C" Foreground="White" 
                                                     BorderBrush="#FF555555" Padding="5" Margin="0,0,0,5">
                                                <ComboBoxItem Content="Unlimited" IsSelected="True"/>
                                                <ComboBoxItem Content="60 FPS"/>
                                                <ComboBoxItem Content="120 FPS"/>
                                                <ComboBoxItem Content="144 FPS"/>
                                                <ComboBoxItem Content="240 FPS"/>
                                            </ComboBox>
                                        </StackPanel>
                                    </GroupBox>
                                </StackPanel>
                            </ScrollViewer>
                        </GroupBox>
                        
                        <!-- Advanced Options -->
                        <GroupBox Header="Advanced Options" Foreground="White" FontWeight="Bold">
                            <StackPanel>
                                <CheckBox x:Name="DebugModeCheckBox" Content="Enable Debug Mode" 
                                         Foreground="White" Margin="0,0,0,10"/>
                                <CheckBox x:Name="ConsoleCheckBox" Content="Show Console Window" 
                                         Foreground="White" Margin="0,0,0,10"/>
                                <CheckBox x:Name="LoggingCheckBox" Content="Enable Detailed Logging" 
                                         Foreground="White" Margin="0,0,0,10"/>
                                
                                <!-- Performance Settings -->
                                <GroupBox Header="Performance Settings" Foreground="White" FontWeight="Bold" Margin="0,10,0,10">
                                    <StackPanel>
                                        <TextBlock Text="System RAM:" Foreground="White" FontWeight="Bold" Margin="0,0,0,8"/>
                                        <RadioButton x:Name="Ram8GBRadio" Content="8GB RAM" 
                                                   Foreground="White" Margin="0,0,0,5" IsChecked="True"/>
                                        <RadioButton x:Name="Ram16GBRadio" Content="16GB RAM" 
                                                   Foreground="White" Margin="0,0,0,5"/>
                                        <RadioButton x:Name="Ram32GBRadio" Content="32GB RAM" 
                                                   Foreground="White" Margin="0,0,0,8"/>
                                        
                                        <Separator Background="#FF555555" Margin="0,5,0,8"/>
                                        
                                        <CheckBox x:Name="LargeAddressAwareCheckBox" Content="Large Address Aware (4GB+ RAM Support)" 
                                                 Foreground="White" Margin="0,0,0,8" IsChecked="True"/>
                                        <CheckBox x:Name="MemoryPoolCheckBox" Content="Memory Pool Optimization" 
                                                 Foreground="White" Margin="0,0,0,8" IsChecked="True"/>
                                        <CheckBox x:Name="GarbageCollectionCheckBox" Content="Advanced Garbage Collection" 
                                                 Foreground="White" Margin="0,0,0,8" IsChecked="True"/>
                                    </StackPanel>
                                </GroupBox>
                                
                                <TextBlock Text="Custom Launch Arguments:" Foreground="White" FontWeight="Bold" Margin="0,10,0,5"/>
                                <TextBox x:Name="CustomArgsTextBox" 
                                        Background="#FF3C3C3C" Foreground="White" 
                                        BorderBrush="#FF555555" Padding="5" Height="60" 
                                        TextWrapping="Wrap" AcceptsReturn="True"/>
                            </StackPanel>
                        </GroupBox>
                        
                    </StackPanel>
                </ScrollViewer>
            </GroupBox>
            
            <!-- Divider -->
            <GridSplitter Grid.Column="1" Background="#FF555555" 
                         HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
            
            <!-- Right Panel - Mod Management -->
            <GroupBox Grid.Column="2" Header="Mod Management" Foreground="White" FontWeight="Bold">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Mod Directory -->
                    <GroupBox Grid.Row="0" Header="Mod Directory" Foreground="White" FontWeight="Bold" Margin="0,0,0,10">
                        <StackPanel>
                            <TextBox x:Name="ModDirectoryTextBox" 
                                    Background="#FF3C3C3C" Foreground="White" 
                                    BorderBrush="#FF555555" Padding="8" Margin="0,0,0,10"/>
                            <Button x:Name="BrowseModsButton" Content="Browse for Mods..." 
                                   Click="BrowseMods_Click" Background="#FF28A745" 
                                   Foreground="White" BorderBrush="#FF28A745" Padding="10,5"/>
                        </StackPanel>
                    </GroupBox>
                    
                    <!-- Mod List -->
                    <GroupBox Grid.Row="1" Header="Available Mods" Foreground="White" FontWeight="Bold">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <ListBox x:Name="ModListBox" Grid.Row="0" 
                                    Background="#FF3C3C3C" BorderBrush="#FF555555"
                                    Foreground="White" SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="#FF4A4A4A" Margin="2" Padding="10" 
                                               CornerRadius="3" BorderBrush="#FF666666" BorderThickness="1">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <StackPanel Grid.Column="0">
                                                    <CheckBox Content="{Binding name}" 
                                                            IsChecked="{Binding IsEnabled}" 
                                                            Foreground="White" FontWeight="Bold" 
                                                            Margin="0,0,0,5"/>
                                                    <TextBlock Text="{Binding version}" 
                                                              FontSize="11" Foreground="#FFCCCCCC" 
                                                              Margin="20,0,0,2"/>
                                                    <TextBlock Text="{Binding author}" 
                                                              FontSize="10" Foreground="#FFAAAAAA" 
                                                              Margin="20,0,0,2"/>
                                                    <TextBlock Text="{Binding description}" 
                                                              FontSize="10" Foreground="#FF888888" 
                                                              Margin="20,0,0,0" TextWrapping="Wrap"/>
                                                </StackPanel>
                                                
                                                <StackPanel Grid.Column="1" Orientation="Horizontal">
                                                    <Ellipse Width="8" Height="8" Fill="Green" 
                                                           Margin="0,0,5,0" VerticalAlignment="Center"/>
                                                    <TextBlock Text="Ready" FontSize="9" 
                                                              VerticalAlignment="Center"/>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            
                            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,10,0,0">
                                <Button x:Name="RefreshModsButton" Content="Refresh" 
                                       Click="RefreshMods_Click" Background="#FF6C757D" 
                                       Foreground="White" BorderBrush="#FF6C757D" 
                                       Padding="10,5" Margin="0,0,10,0"/>
                                <Button x:Name="SelectAllModsButton" Content="Select All" 
                                       Click="SelectAllMods_Click" Background="#FF007ACC" 
                                       Foreground="White" BorderBrush="#FF007ACC" 
                                       Padding="10,5" Margin="0,0,10,0"/>
                                <Button x:Name="DeselectAllModsButton" Content="Deselect All" 
                                       Click="DeselectAllMods_Click" Background="#FFDC3545" 
                                       Foreground="White" BorderBrush="#FFDC3545" 
                                       Padding="10,5" Margin="0,0,10,0"/>
                                <Button x:Name="ApplySelectedModsButton" Content="✅ Apply Selected" 
                                       Click="ApplySelectedMods_Click" Background="#FF28A745" 
                                       Foreground="White" BorderBrush="#FF28A745" 
                                       Padding="10,5" Margin="0,0,10,0"/>
                                <Button x:Name="UnapplyAllModsButton" Content="❌ Unapply All" 
                                       Click="UnapplyAllMods_Click" Background="#FF6C757D" 
                                       Foreground="White" BorderBrush="#FF6C757D" 
                                       Padding="10,5"/>
                            </StackPanel>
                        </Grid>
                    </GroupBox>
                    
                    <!-- Launch Controls -->
                    <GroupBox Grid.Row="2" Header="Launch Controls" Foreground="White" FontWeight="Bold" Margin="0,10,0,0">
                        <StackPanel>
                            <Button x:Name="LaunchGameButton" Content="🚀 Launch Castle Story with Mods" 
                                   Click="LaunchGame_Click" Background="#FF28A745" 
                                   Foreground="White" BorderBrush="#FF28A745" 
                                   Padding="20,10" FontSize="16" FontWeight="Bold" 
                                   Margin="0,0,0,10"/>
                            
                            
                            
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <Button x:Name="StopGameButton" Content="⏹ Stop Game" 
                                       Click="StopGame_Click" Background="#FFDC3545" 
                                       Foreground="White" BorderBrush="#FFDC3545" 
                                       Padding="15,5" Margin="0,0,5,0"/>
                                <Button x:Name="RestartGameButton" Content="🔄 Restart Game" 
                                       Click="RestartGame_Click" Background="#FFFFC107" 
                                       Foreground="Black" BorderBrush="#FFFFC107" 
                                       Padding="15,5"/>
                            </StackPanel>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </GroupBox>
        </Grid>
        
        <!-- Status Bar -->
        <Border Grid.Row="2" Background="#FF3C3C3C" Padding="15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Ellipse x:Name="StatusIndicator" Width="12" Height="12" Fill="Red" Margin="0,0,8,0"/>
                    <TextBlock x:Name="StatusText" Text="Ready to launch" 
                              Foreground="White" FontWeight="Bold"/>
                </StackPanel>
                
                <TextBlock Grid.Column="1" x:Name="GameStatusText2" Text="Game: Not Running" 
                          Foreground="#FFCCCCCC" Margin="20,0"/>
                
                <TextBlock Grid.Column="2" x:Name="ModCountText" Text="0 mods selected" 
                          Foreground="#FFCCCCCC"/>
            </Grid>
        </Border>
    </Grid>
</Window>
